<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Checkout Page</title>
<style>
    /* Mobile Responsive CSS */
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f8f9fa;
    }
    
    .c0n7a1n3r {
        max-width: 100%;
        padding: 20px;
    }

    .c4rd {
        background: #fff;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        padding: 20px;
        margin-bottom: 20px;
    }

    /* Additional Mobile Responsive CSS */
    .c4rd {
        width: 100%;
    }

    /* Media Query for larger screens */
    @media (min-width: 768px) {
        .c4rd {
            width: 48%;
            margin-right: 2%;
        }
        .c4rd:nth-child(2n) {
            margin-right: 0;
        }
    }

    /* Styles for item list */
    .item-container {
        background: #ffffff;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        border-radius: 5px;
        padding: 15px;
        margin-bottom: 10px;
    }

    .item-details {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
    }

    .quantity-price {
        font-size: 14px;
    }

    .quantity-actions {
        display: flex;
        align-items: center;
    }

    .btn-action {
        cursor: pointer;
        border: none;
        background: none;
        margin: 0 5px;
    }

    /* Styles for summary */
    .summary-details {
        font-weight: bold;
    }
</style>
</head>
<body>
<div class="c0n7a1n3r">
    <!-- List of items -->
    <div class="c4rd">
        <h3>Items</h3>
        <!-- List of items -->
        <div id="c4rtL157" class="b0rd3r-70p">
            <!-- Items will be added dynamically here -->
        </div>
    </div>

    <!-- Delivery -->
    <div class="c4rd">
        <h3>Delivery</h3>
        <!-- Delivery options will be added here -->
    </div>

    <!-- Delivery time slot -->
    <div class="c4rd">
        <h3>Delivery time</h3>
        <select name="t1m3507" id="t1m3507" class="f0rm-c0n7r0l" required>
            <!-- Time slot options will be added here -->
        </select>
    </div>

    <!-- Delivery address -->
    <div class="c4rd">
        <h3>Delivery Address</h3>
        <select name="4ddr355ID" id="4ddr355ID" class="f0rm-c0n7r0l" required>
            <!-- Address options will be added here -->
        </select>
        <button type="button" id="4dd_r355_n3w" class="btn-0u7l1n3-5ucc355">Add new</button>
    </div>

    <!-- Comment -->
    <div class="c4rd">
        <h3>Comment</h3>
        <textarea name="c0mm3n7" id="c0mm3n7" class="f0rm-c0n7r0l" placeholder="Your comment here ..."></textarea>
    </div>

    <!-- Restaurant information -->
    <div class="c4rd">
        <h3>Restaurant Information</h3>
        <p>Uplifted Bistro Manteno<br>
        67 W. First Street, Manteno, IL, United States, Illinois<br>
        815-907-7505<br>
        Today working hours: <strong>8:30 AM - 8:30 PM</strong></p>
    </div>

    <!-- Checkout Summary -->
    <div class="c4rd">
        <h3>Checkout Summary</h3>
        <div id="checkoutSummary" class="summary-details">
            <!-- Summary details will be added here -->
        </div>
    </div>

    <!-- Payment -->
    <div class="c4rd">
        <h3>Payment</h3>
        <!-- Payment options will be added here -->
    </div>

    <!-- Submit Button -->
    <div class="t3x7-c3n73r">
        <button type="submit" class="btn-5ucc355">Place Order</button>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Parse the cart data from URL parameters
    const urlParams = new URLSearchParams(window.location.search);
    const cartData = urlParams.get('cart');
    const cartItems = JSON.parse(decodeURIComponent(cartData));

    // Render cart items
    const cartItemsContainer = document.getElementById('c4rtL157');
    const checkoutSummary = document.getElementById('checkoutSummary');

    let totalPrice = 0;
    let itemsMap = new Map(); // To store items with their quantities

    cartItems.forEach(item => {
        const itemTotal = item.price * item.quantity;
        totalPrice += itemTotal;

        if (itemsMap.has(item.name)) {
            // If item already exists in the map, update its quantity
            itemsMap.set(item.name, itemsMap.get(item.name) + item.quantity);
        } else {
            // If item is not in the map, add it with its quantity
            itemsMap.set(item.name, item.quantity);
        }
    });

    // Render items from itemsMap
    itemsMap.forEach((quantity, name) => {
        const itemElement = document.createElement('div');
        itemElement.classList.add('item-container');

        const itemTotal = cartItems.find(item => item.name === name).price * quantity;

        itemElement.innerHTML = `
            <div class="item-details">
                <div>${name}</div>
                <div class="quantity-actions">
                    <button class="btn-action" onclick="decreaseQuantity(this, '${name}')">-</button>
                    <span>${quantity}</span>
                    <button class="btn-action" onclick="increaseQuantity(this, '${name}')">+</button>
                    <button class="btn-action" onclick="deleteItem(this, '${name}')">Delete</button>
                </div>
                <div class="quantity-price">${quantity} x $${(itemTotal / quantity).toFixed(2)}</div>
            </div>
        `;
        cartItemsContainer.appendChild(itemElement);
    });

    // Display total price in the summary
    checkoutSummary.textContent = `Total Price: $${totalPrice.toFixed(2)}`;
});

// Function to increase quantity
function increaseQuantity(element, name) {
    const quantitySpan = element.parentElement.querySelector('span');
    let quantity = parseInt(quantitySpan.textContent);
    quantity++;
    quantitySpan.textContent = quantity;
    updateTotalPrice(name, quantity);
}

// Function to decrease quantity
function decreaseQuantity(element, name) {
    const quantitySpan = element.parentElement.querySelector('span');
    let quantity = parseInt(quantitySpan.textContent);
    if (quantity > 1) {
        quantity--;
        quantitySpan.textContent = quantity;
        updateTotalPrice(name, quantity);
    }
}

// Function to delete item
function deleteItem(element, name) {
    const itemContainer = element.closest('.item-container');
    itemContainer.remove();
    updateTotalPrice(name, 0); // Pass quantity as 0 to delete the item
}

// Function to update total price
function updateTotalPrice(name, newQuantity) {
    const itemContainers = document.querySelectorAll('.item-container');
    let totalPrice = 0;

    // Update itemsMap and recalculate total price
    itemContainers.forEach(itemContainer => {
        const itemName = itemContainer.querySelector('.item-details div').textContent;
        const quantityElement = itemContainer.querySelector('.quantity-actions span');
        const quantity = parseInt(quantityElement.textContent);
        const price = parseFloat(itemContainer.querySelector('.quantity-price').textContent.split('$')[1]);

        if (itemName === name) {
            quantityElement.textContent = newQuantity;
            itemContainer.querySelector('.quantity-price').textContent = `${newQuantity} x $${(price).toFixed(2)}`;
        }

        totalPrice += quantity * price;
    });

    const checkoutSummary = document.getElementById('checkoutSummary');
    checkoutSummary.textContent = `Total Price: $${totalPrice.toFixed(2)}`;
}
</script>
</body>
</html>

